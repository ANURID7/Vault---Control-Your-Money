{% extends "base.html" %}
{% block content %}

<style>

/* ===== Variables ===== */
:root {
    --primary: #0F3D3E;
    --primary-light: #1A5A5B;
    --primary-dark: #0A2D2E;
    --accent: #14B8A6;
    --accent-gradient: linear-gradient(135deg, #14B8A6, #0D9488);
    --success: #10B981;
    --success-soft: rgba(16, 185, 129, 0.1);
    --danger: #EF4444;
    --danger-soft: rgba(239, 68, 68, 0.1);
    --bg-main: #EEF2F7;
    --bg-card: #FFFFFF;
    --text-primary: #0F172A;
    --text-secondary: #475569;
    --text-tertiary: #64748B;
    --border-light: #F1F5F9;
    --shadow-sm: 0 4px 12px rgba(0, 0, 0, 0.02);
    --shadow-md: 0 8px 24px rgba(0, 0, 0, 0.04);
    --shadow-lg: 0 20px 50px rgba(15, 23, 42, 0.08);
    --shadow-hover: 0 30px 60px -12px rgba(20, 184, 166, 0.25);
}

/* ===== Header ===== */

.page-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 28px;
    padding: 8px 0;
}

.brand-mini {
    display: flex;
    align-items: center;
    gap: 8px;
}

.brand-mini span {
    font-family: 'Sora', sans-serif;
    font-size: 24px;
    font-weight: 800;
    letter-spacing: -0.5px;
    color: var(--primary);
    line-height: 1;
}

.brand-mini i {
    width: 10px;
    height: 10px;
    background: var(--accent);
    border-radius: 3px;
    display: inline-block;
}

.header-actions {
    display: flex;
    align-items: center;
    gap: 12px;
}

.header-btn {
    width: 44px;
    height: 44px;
    border-radius: 16px;
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(203, 213, 225, 0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
}

.header-btn:hover {
    transform: translateY(-2px);
    border-color: var(--accent);
    box-shadow: 0 10px 20px -8px rgba(20, 184, 166, 0.3);
}

.header-btn img {
    width: 20px;
    opacity: 0.7;
    transition: opacity 0.2s;
}

.header-btn:hover img {
    opacity: 1;
}

.notification-badge {
    position: absolute;
    top: 8px;
    right: 8px;
    width: 8px;
    height: 8px;
    background: var(--danger);
    border-radius: 50%;
    border: 2px solid white;
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.2); opacity: 0.7; }
    100% { transform: scale(1); opacity: 1; }
}

/* ===== Summary Card ===== */

.summary-card {
    background: var(--bg-card);
    border-radius: 32px;
    padding: 32px 24px;
    box-shadow: var(--shadow-lg);
    margin-bottom: 32px;
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.5);
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
    animation: slideUp 0.5s ease;
}

.summary-card:hover {
    box-shadow: var(--shadow-hover);
    transform: translateY(-4px);
}

/* ===== Elegant Ring ===== */

.ring-container {
    position: relative;
    width: 160px;
    height: 160px;
    margin: 0 auto 20px;
}

.ring-container canvas {
    width: 100% !important;
    height: 100% !important;
    filter: drop-shadow(0 8px 16px rgba(20, 184, 166, 0.15));
    transition: filter 0.3s ease;
}

.ring-container:hover canvas {
    filter: drop-shadow(0 12px 24px rgba(20, 184, 166, 0.25));
}

.ring-center {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(4px);
    width: 108px;  /* Increased from 100px (4px radius increase = 8px diameter increase) */
    height: 108px; /* Increased from 100px */
    border-radius: 50%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    border: 2px solid white;
}

.ring-amount {
    font-size: 22px;
    font-weight: 800;
    color: var(--primary);
    line-height: 1.2;
}

.ring-budget {
    font-size: 11px;
    color: var(--text-tertiary);
    margin-top: 2px;
    font-weight: 500;
}

.ring-percent {
    font-size: 12px;
    margin-top: 4px;
    font-weight: 700;
    background: var(--accent-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    padding: 2px 8px;
    border-radius: 30px;
    background-color: var(--accent-soft);
}

/* Quick Stats Row */
.quick-stats-row {
    display: flex;
    justify-content: space-around;
    margin-top: 16px;
    padding-top: 20px;
    border-top: 2px dashed var(--border-light);
}

.quick-stat {
    text-align: center;
}

.quick-stat-label {
    font-size: 12px;
    color: var(--text-tertiary);
    font-weight: 500;
    margin-bottom: 4px;
}

.quick-stat-value {
    font-size: 18px;
    font-weight: 700;
    color: var(--text-primary);
}

.quick-stat-value.positive {
    color: var(--success);
}

.quick-stat-value.negative {
    color: var(--danger);
}

/* ===== Transactions Section ===== */

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    position: relative;
}

.section-title {
    font-size: 20px;
    font-weight: 700;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 8px;
}

.section-title i {
    width: 4px;
    height: 20px;
    background: var(--accent);
    border-radius: 4px;
}

/* Add Transaction Button in Header - Text Only */
.add-transaction-btn {
    height: 44px;
    border-radius: 22px;
    background: var(--accent-gradient);
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 4px 12px rgba(20, 184, 166, 0.3);
    padding: 0 20px;
    gap: 6px;
    color: white;
    font-weight: 600;
    font-size: 15px;
}

.add-transaction-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 20px rgba(20, 184, 166, 0.5);
}

.add-transaction-btn:active {
    transform: scale(0.95);
}

.add-transaction-btn span {
    font-size: 22px;
    font-weight: 400;
    line-height: 1;
}

/* Floating Action Button - Hidden by default */
.fab {
    position: fixed;
    bottom: 24px;
    right: 24px;
    height: 56px;
    border-radius: 28px;
    background: var(--accent-gradient);
    box-shadow: 0 8px 20px rgba(20, 184, 166, 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border: 2px solid white;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transform: translateY(20px);
    padding: 0 24px;
    gap: 8px;
}

.fab.visible {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.fab:hover {
    transform: scale(1.05) translateY(-4px);
    box-shadow: 0 16px 32px rgba(20, 184, 166, 0.6);
}

.fab:active {
    transform: scale(0.95);
}

.fab-icon {
    font-size: 28px;
    font-weight: 300;
    color: white;
    line-height: 1;
    margin-bottom: 2px;
}

.fab-text {
    font-size: 16px;
    font-weight: 600;
    color: white;
    letter-spacing: 0.3px;
}

.transaction-group {
    margin-bottom: 28px;
    animation: slideUp 0.5s ease;
    animation-fill-mode: both;
}

.delay-1 { animation-delay: 0.1s; }
.delay-2 { animation-delay: 0.2s; }
.delay-3 { animation-delay: 0.3s; }
.delay-4 { animation-delay: 0.4s; }

.transaction-date {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-secondary);
    margin-bottom: 12px;
    padding-left: 8px;
    letter-spacing: 0.3px;
}

.transaction-list {
    background: var(--bg-card);
    border-radius: 24px;
    box-shadow: var(--shadow-md);
    overflow: hidden;
    border: 1px solid var(--border-light);
    transition: all 0.3s ease;
}

.transaction-list:hover {
    box-shadow: var(--shadow-lg);
}

.transaction-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 18px 20px;
    border-bottom: 1px solid var(--border-light);
    transition: all 0.2s ease;
    cursor: pointer;
}

.transaction-item:last-child {
    border-bottom: none;
}

.transaction-item:hover {
    background: linear-gradient(90deg, #F8FAFC, #FFFFFF);
    padding-left: 24px;
}

.transaction-left {
    display: flex;
    flex-direction: column;
}

.transaction-name {
    font-size: 15px;
    font-weight: 600;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 8px;
}

.transaction-category {
    font-size: 10px;
    font-weight: 600;
    padding: 3px 8px;
    border-radius: 30px;
    background: var(--accent-soft);
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 0.3px;
}

.transaction-time {
    font-size: 12px;
    color: var(--text-tertiary);
    margin-top: 4px;
}

.transaction-amount {
    font-size: 16px;
    font-weight: 700;
    padding: 6px 12px;
    border-radius: 30px;
    transition: all 0.2s ease;
}

.expense {
    color: var(--danger);
    background: var(--danger-soft);
}

.income {
    color: var(--success);
    background: var(--success-soft);
}

.transaction-item:hover .transaction-amount {
    transform: scale(1.05);
}

/* ===== Animations ===== */

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.animate-slide-up {
    animation: slideUp 0.5s ease forwards;
}

.animate-fade-in {
    animation: fadeIn 0.5s ease forwards;
}

/* ===== Empty State ===== */

.empty-state {
    text-align: center;
    padding: 40px 20px;
    background: #F8FAFC;
    border-radius: 24px;
    color: var(--text-tertiary);
}

.empty-state p {
    margin-top: 8px;
    font-size: 14px;
}

/* ===== Responsive ===== */

@media (max-width: 380px) {
    .ring-container {
        width: 140px;
        height: 140px;
    }
    
    .ring-center {
        width: 92px;  /* Adjusted proportionally for smaller screens */
        height: 92px;
    }
    
    .ring-amount {
        font-size: 18px;
    }
    
    .transaction-item {
        padding: 14px 16px;
    }
    
    .fab {
        padding: 0 20px;
        height: 48px;
    }
    
    .fab-text {
        font-size: 14px;
    }
    
    .fab-icon {
        font-size: 24px;
    }
    
    .add-transaction-btn {
        padding: 0 16px;
        font-size: 14px;
        height: 40px;
    }
}
</style>

<!-- ===== Header with Vault Brand ===== -->

<div class="page-header animate-slide-up">
    <div class="brand-mini">
        <span>Vault</span>
        <i></i>
    </div>
    <div class="header-actions">
        <div class="header-btn" onclick="openVideo()">
            <img src="{{ url_for('static', filename='video-icon.png') }}" alt="Video">
        </div>
        <div class="header-btn" onclick="notifications()">
            <img src="{{ url_for('static', filename='bell-icon.png') }}" alt="Notifications">
            <span class="notification-badge"></span>
        </div>
    </div>
</div>

<!-- ===== Summary Ring with Quick Stats ===== -->

<div class="summary-card animate-slide-up delay-1">

    <div class="ring-container">
        <canvas id="expenseRing"></canvas>

        <div class="ring-center">
            <div class="ring-amount">â‚¹32,450</div>
            <div class="ring-budget">of â‚¹45,000</div>
            <div class="ring-percent">72% Used</div>
        </div>
    </div>

    <!-- Quick Stats -->
    <div class="quick-stats-row">
        <div class="quick-stat">
            <div class="quick-stat-label">Today's Spending</div>
            <div class="quick-stat-value negative">-â‚¹1,250</div>
        </div>
        <div class="quick-stat">
            <div class="quick-stat-label">Amount Left</div>
            <div class="quick-stat-value positive">+â‚¹12,550</div>
        </div>
    </div>

</div>

<!-- ===== Transaction History Header with Add Button (No Image) ===== -->

<div class="section-header animate-fade-in delay-2">
    <div class="section-title">
        <i></i> Transaction History
    </div>
    <div class="add-transaction-btn" onclick="addTransaction()">
        <span>+</span> Add
    </div>
</div>

<!-- Today's Transactions -->
<div class="transaction-group delay-2">

    <div class="transaction-date">Today</div>

    <div class="transaction-list">

        <div class="transaction-item" onclick="viewTransaction('uber')">
            <div class="transaction-left">
                <div class="transaction-name">
                    Uber Ride
                    <span class="transaction-category">Transport</span>
                </div>
                <div class="transaction-time">10:32 AM</div>
            </div>
            <div class="transaction-amount expense">- â‚¹350</div>
        </div>

        <div class="transaction-item" onclick="viewTransaction('salary')">
            <div class="transaction-left">
                <div class="transaction-name">
                    Salary Credit
                </div>
                <div class="transaction-time">09:05 AM</div>
            </div>
            <div class="transaction-amount income">+ â‚¹50,000</div>
        </div>

    </div>

</div>

<!-- Yesterday's Transactions -->
<div class="transaction-group delay-3">

    <div class="transaction-date">Yesterday</div>

    <div class="transaction-list">

        <div class="transaction-item" onclick="viewTransaction('amazon')">
            <div class="transaction-left">
                <div class="transaction-name">
                    Amazon Shopping
                    <span class="transaction-category">Shopping</span>
                </div>
            </div>
            <div class="transaction-amount expense">- â‚¹2,100</div>
        </div>

        <div class="transaction-item" onclick="viewTransaction('grocery')">
            <div class="transaction-left">
                <div class="transaction-name">
                    Grocery Store
                    <span class="transaction-category">Food</span>
                </div>
            </div>
            <div class="transaction-amount expense">- â‚¹1,450</div>
        </div>

        <div class="transaction-item" onclick="viewTransaction('electricity')">
            <div class="transaction-left">
                <div class="transaction-name">
                    Electricity Bill
                    <span class="transaction-category">Bills</span>
                </div>
            </div>
            <div class="transaction-amount expense">- â‚¹3,200</div>
        </div>

    </div>

</div>

<!-- Previous Week Section -->
<div class="transaction-group delay-4">

    <div class="transaction-date">10 September 2024</div>

    <div class="transaction-list">

        <div class="transaction-item" onclick="viewTransaction('netflix')">
            <div class="transaction-left">
                <div class="transaction-name">
                    Netflix Subscription
                    <span class="transaction-category">Entertainment</span>
                </div>
            </div>
            <div class="transaction-amount expense">- â‚¹649</div>
        </div>

    </div>

</div>

<!-- Floating Action Button with + and text (hidden initially) -->
<div class="fab" id="fab" onclick="addTransaction()">
    <span class="fab-icon">+</span>
    <span class="fab-text">Add Transaction</span>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>

/* ===== Elegant Ring Progress with Animation ===== */

const ctx = document.getElementById('expenseRing').getContext('2d');

const gradient = ctx.createLinearGradient(0, 0, 0, 200);
gradient.addColorStop(0, '#14B8A6');
gradient.addColorStop(1, '#0F766E');

// Animate the ring on load
let currentPercent = 0;
const targetPercent = 72;

const ringChart = new Chart(ctx, {
    type: 'doughnut',
    data: {
        datasets: [{
            data: [0, 100],
            backgroundColor: [
                gradient,
                '#E2E8F0'
            ],
            borderWidth: 0,
            cutout: '88%',
            borderRadius: 10,
        }]
    },
    options: {
        responsive: true,
        plugins: { 
            legend: { display: false },
            tooltip: { enabled: false }
        },
        animation: {
            animateRotate: true,
            animateScale: true,
            duration: 1500,
            easing: 'easeOutQuart'
        }
    }
});

// Animate the data
setTimeout(() => {
    ringChart.data.datasets[0].data = [targetPercent, 100 - targetPercent];
    ringChart.update();
}, 200);

/* ===== Scroll-based FAB Visibility ===== */

const fab = document.getElementById('fab');
let lastScrollTop = 0;
const summaryCard = document.querySelector('.summary-card');
const summaryCardHeight = summaryCard.offsetHeight;

window.addEventListener('scroll', function() {
    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
    
    // Show FAB when scrolled past the summary card
    if (scrollTop > summaryCardHeight) {
        fab.classList.add('visible');
    } else {
        fab.classList.remove('visible');
    }
    
    lastScrollTop = scrollTop;
});

/* ===== Interactive Functions ===== */

function searchTransactions() {
    alert('ðŸ” Search transactions by name, category, or amount');
}

function notifications() {
    alert('ðŸ“¬ 3 new notifications:\nâ€¢ Bill payment due tomorrow\nâ€¢ Large transaction detected\nâ€¢ Monthly report ready');
}

function viewTransaction(name) {
    const details = {
        'uber': 'Uber ride from Office to Home â€¢ 3.2 km â€¢ â‚¹350',
        'salary': 'Monthly salary credit â€¢ TechCorp Inc. â€¢ â‚¹50,000',
        'amazon': 'Amazon order #IN-23456 â€¢ Electronics â€¢ â‚¹2,100',
        'grocery': 'Weekly grocery shopping â€¢ FreshMart â€¢ â‚¹1,450',
        'electricity': 'Electricity bill for September â€¢ â‚¹3,200',
        'netflix': 'Netflix Premium â€¢ Monthly subscription â€¢ â‚¹649'
    };
    alert('ðŸ“‹ Transaction Details:\n' + (details[name] || 'Loading transaction details...'));
}

function addTransaction() {
    alert('âž• Add New Transaction:\nâ€¢ Expense\nâ€¢ Income\nâ€¢ Transfer');
}

// Add animation on scroll
document.addEventListener('DOMContentLoaded', function() {
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    });

    document.querySelectorAll('.transaction-group').forEach(el => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(20px)';
        el.style.transition = 'all 0.5s ease';
        observer.observe(el);
    });
});

</script>

{% endblock %}